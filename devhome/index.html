<html>
<style>
    #notes {
        display: flex;
        flex-wrap: wrap;
        margin: 0 auto;
    }

    .note {
        width: 200px;
        height: 200px;
        border: 1px solid black;
        margin: 10px;
        padding: 10px;
    }

    .note-head {
        height: 20px;
        border-bottom: 1px solid black;
    }

    .note-body {
        height: 150px;
        border: 1px solid black;
    }

    .note-footer {
        height: 20px;
    }

    #header {
        text-align: center;
    }

    #user {
        font-size: 20px;
    }
</style>

<body>
    <!--
            Simple contenteditable div for a place to leave a note
        -->
    <main>
        <div id="header">
            <h1>RAU.DEV Home (Preview)</h1>
            <div id="refresh">
                <button onclick="refresh()">Refresh</button>
            </div>
            <hr>
            <p id="user"></p>
        </div>
        <div id="dev">
            Loading...
        </div>
    </main>

    <script>
        // Load user data

        function data(loading=true) {

            if(loading)
                document.getElementById('dev').innerHTML = 'Loading...';
            
                fetch('https://rau.dev/api/dev')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('user').innerHTML = data.result

                    fetch('https://rau.dev/api/dev/home')
                        .then(response => response.text())
                        .then(data => {
                            document.getElementById('dev').innerHTML = data;

                            let addform = document.getElementById('addform');
                            if(addform) {
                                addform.addEventListener('submit', (e) => {
                                    e.preventDefault();
                                    e.stopPropagation();
                                    fetch('https://rau.dev/api/dev/add', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({
                                            title: 'Hello',
                                            content: 'World'
                                        })
                                    })
                                        .then(response => response.json())
                                        .then(data => {
                                            console.log(data);
                                            refresh();
                                        })
                                })
                            }
                        })
                });
        }

        function load() {
            data();
        }

        function refresh() {
            data(false);
        }

        window.onload = load;

    </script>
</body>

</html>